<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Dream Bubbles â€” Spotify System</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <!-- Styles -->
  <link rel="stylesheet" href="style.css" />

  <!-- Three.js & OrbitControls -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/examples/js/controls/OrbitControls.min.js"></script>
</head>

<body>
  <!-- 3D Scene Canvas -->
  <canvas id="canvas"></canvas>
  <div id="ribbon" class="idle"></div>

  <!-- UI Cluster -->
  <div id="uiCluster">
    <!-- Playlist Panel -->
    <div id="playlistPanel" class="panel">
      <h3>Now Playing</h3>
      <iframe id="spotifyPlayer"
        src="https://open.spotify.com/embed/playlist/37i9dQZF1DX6J5NfMJS675"
        allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
        loading="lazy"></iframe>
    </div>

    <!-- Genre Panel -->
    <div id="genrePanel" class="panel">
      <div id="genreBar">
        <span data-genre="hard-techno">Hard Techno</span>
        <span data-genre="techno">Techno</span>
        <span data-genre="house">House</span>
        <span data-genre="drum-bass">Drum & Bass</span>
        <span data-genre="dubstep">Dubstep</span>
        <span data-genre="electronic">Electronic / Dance</span>
        <span data-genre="pop">Pop / International</span>
      </div>
    </div>
  </div>

  <!-- Galaxy App -->
  <script src="app.js"></script>

  <script>
    // --- Playlist + background logic ---
    const playlists = {
      "hard-techno": "https://open.spotify.com/embed/playlist/6kA6f1C5rITf7k7w1oBGVv",
      "techno": "https://open.spotify.com/embed/playlist/37i9dQZF1DX6J5NfMJS675",
      "house": "https://open.spotify.com/embed/playlist/7bu7BZEusLNJSaAuUUZBKn",
      "drum-bass": "https://open.spotify.com/embed/playlist/0g37FHWjuxodt8Auj096hA",
      "dubstep": "https://open.spotify.com/embed/playlist/3ObJ6Qra3CkV0gNCRTtK0c",
      "electronic": "https://open.spotify.com/embed/playlist/37i9dQZF1DXa1pcUVlBhYz",
      "pop": "https://open.spotify.com/embed/playlist/37i9dQZF1DXcBWIGoYBM5M"
    };

    const genreSpans = document.querySelectorAll("#genreBar span");
    const player = document.getElementById("spotifyPlayer");

    genreSpans.forEach(span => {
      span.addEventListener("click", () => {
        genreSpans.forEach(s => s.classList.remove("active"));
        span.classList.add("active");

        const genre = span.getAttribute("data-genre");
        const url = playlists[genre];

        if (url) {
          player.classList.add("fade-out");
          setTimeout(() => {
            player.src = url;
            player.classList.remove("fade-out");
          }, 800);
        }
      });
    });

    // Set Techno active initially
    document.querySelector('[data-genre="techno"]').classList.add("active");
  </script>
</body>
</html>
